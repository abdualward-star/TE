name: Freqtrade Data Download

on:
  workflow_dispatch:

jobs:
  download_data:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout repository
        uses: actions/checkout@v4

      - name: Setup Python
        uses: actions/setup-python@v4
        with:
          python-version: '3.11'

      - name: Install TA-Lib (amd64)
        run: |
          wget -q https://github.com/ta-lib/ta-lib/releases/download/v0.6.4/ta-lib_0.6.4_amd64.deb
          sudo dpkg -i ta-lib_0.6.4_amd64.deb
          sudo apt-get install -f -y  # لتثبيت أي تبعيات مفقودة

      - name: Install Python dependencies
        run: |
          python -m pip install --upgrade pip
          pip install ta-lib
          pip install freqtrade

      - name: Download Binance Data
        run: |
          freqtrade download-data \
            --timeframes 15m \
            --exchange binance \
            --pairs ETH/USDT ETH/BTC XRP/USDT BTC/USDT XRP/ETH \
            --prepend \
            --timerange 20210101-20250101
